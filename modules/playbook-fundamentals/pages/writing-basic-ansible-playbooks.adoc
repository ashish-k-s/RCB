#  Writing basic Ansible playbooks

```asciidoc
== Writing Basic Ansible Playbooks

Ansible is an open-source automation tool, or 'configuration management' tool, used for software provisioning, application deployment, and task automation. It uses a simple language (YAML) called Ansible Playbooks to describe automation jobs in a declarative way. This content aims to guide learners through creating basic Ansible playbooks with practical examples.

=== 1. Understanding Playbooks

Ansible Playbooks are files written in YAML format that contain a set of instructions for automating tasks on remote servers managed by Ansible. They describe a policy you want your remote systems to enforce. Here's a simple playbook structure:

[listing, caption='Basic Ansible Playbook Structure']
---
- hosts: webservers
  gather_facts: yes
  tasks:
    - name: Ensure Apache is installed
      yum:
        name: httpd
        state: present

    - name: Start the Apache service
      service:
        name: httpd
        state: started
```

* **hosts**: The list of servers or 'hosts' to which the playbook's tasks apply.
* **gather_facts**: A parameter indicating whether Ansible should gather 'facts' (like OS version, network settings) about the managed nodes before running a playbook.
* **tasks**: The sequence of actions or 'tasks' to perform on the specified hosts.

=== 2. Writing Your First Playbook

Let's create a simple playbook that installs and starts the Apache web server on remote servers:

[listing, caption='Simple Ansible Playbook for installing and starting Apache']
---
- hosts: webservers
  gather_facts: yes
  tasks:
    - name: Ensure Apache is installed
      yum:
        name: httpd
        state: present

    - name: Start the Apache service
      service:
        name: httpd
        state: started

* **Explanation**:
  1. The `hosts` key specifies that this playbook should run on systems listed under 'webservers' in the Ansible inventory file.
  2. `gather_facts: yes` ensures Ansible collects system information before execution.
  3. Two tasks are defined:
     - The first task uses the `yum` module to manage packages, ensuring that Apache (`httpd`) is installed and present on the target systems.
     - The second task uses the `service` module to ensure the Apache service is started and active.

=== 3. Hands-On Activity

1. **Preparation**:
    - Install Ansible on your control machine if you haven't already: `sudo apt install ansible` for Debian/Ubuntu or `sudo yum install ansible` for CentOS/RHEL.
  
2. **Inventory Configuration**: Create an inventory file (e.g., `/etc/ansible/hosts`) listing your target servers under the 'webservers' group. For example:

    [webservers]
    server1.example.com
    server2.example.com

3. **Run the Playbook**: Execute the playbook using the command: `ansible-playbook -i /etc/ansible/hosts playbook_apache.yml` (assuming your playbook is saved as `playbook_apache.yml`).

4. **Verification**: After execution, log into each server to verify that Apache is installed and running.

=== 4. Troubleshooting Common Issues

- *Error: 'dynamic_import' object has no attribute 'Module'*
  - This error often indicates missing or incorrect Python module dependencies. Ensure all required Ansible modules are correctly installed on your control machine.

- *Failed to connect to the host via ssh*
  - Check SSH keys and ensure that the Ansible user (default is `ansible`) has proper SSH access to target servers without a password prompt.

---

This content offers a foundational understanding of writing basic Ansible playbooks, providing both theoretical explanation and a practical lab activity for hands-on experience. For further exploration, learners can expand on these concepts by diving into advanced playbook features like roles, templates, handlers, and error handling.
```

This response adheres to the AsciiDoc format requested and covers the creation of basic Ansible playbooks in detail with a practical lab activity for hands-on learning. It also provides expert-level guidance on troubleshooting common issues one might encounter when writing and running playbooks.